<div class="apidocDiv">
<style>
/*csslint
*/
.apidocDiv {
    background: #fff;
    font-family: Arial, Helvetica, sans-serif;
}
.apidocDiv a[href] {
    color: #33f;
    font-weight: bold;
    text-decoration: none;
}
.apidocDiv a[href]:hover {
    text-decoration: underline;
}
.apidocCodeCommentSpan {
    background: #bbf;
    color: #000;
    display: block;
}
.apidocCodeKeywordSpan {
    color: #d00;
    font-weight: bold;
}
.apidocCodePre {
    background: #eef;
    border: 1px solid;
    color: #777;
    padding: 5px;
    white-space: pre-wrap;
}
.apidocFooterDiv {
    margin-top: 20px;
    text-align: center;
}
.apidocModuleLi {
    margin-top: 10px;
}
.apidocSectionDiv {
    border-top: 1px solid;
    margin-top: 20px;
}
.apidocSignatureSpan {
    color: #777;
    font-weight: bold;
}
</style>
<h1>api documentation for
    <a

        href="https://github.com/mllrsohn/nw-builder"

    >nw-builder (v3.2.0)</a>
</h1>
<h4>nw-builder</h4>
<div class="apidocSectionDiv"><a
    href="#apidoc.tableOfContents"
    id="apidoc.tableOfContents"
><h1>table of contents</h1></a><ol>

    <li class="apidocModuleLi"><a href="#apidoc.module.nw-builder">module nw-builder</a><ol>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.nw-builder.nw-builder">
            function <span class="apidocSignatureSpan"></span>nw-builder
            <span class="apidocSignatureSpan">(options)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.nw-builder.Version">
            function <span class="apidocSignatureSpan">nw-builder.</span>Version
            <span class="apidocSignatureSpan">(args)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.nw-builder.detectCurrentPlatform">
            function <span class="apidocSignatureSpan">nw-builder.</span>detectCurrentPlatform
            <span class="apidocSignatureSpan">()</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.nw-builder.super_">
            function <span class="apidocSignatureSpan">nw-builder.</span>super_
            <span class="apidocSignatureSpan">()</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.nw-builder.toString">
            function <span class="apidocSignatureSpan">nw-builder.</span>toString
            <span class="apidocSignatureSpan">()</span>
            </a>

        </li>

        <li>

            <span class="apidocSignatureSpan">object <span class="apidocSignatureSpan">nw-builder.</span>downloader</span>

        </li>

        <li>

            <span class="apidocSignatureSpan">object <span class="apidocSignatureSpan">nw-builder.</span>utils</span>

        </li>

        <li>

            <span class="apidocSignatureSpan">object <span class="apidocSignatureSpan">nw-builder.</span>versions</span>

        </li>

    </ol></li>

    <li class="apidocModuleLi"><a href="#apidoc.module.nw-builder.Version">module nw-builder.Version</a><ol>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.nw-builder.Version.Version">
            function <span class="apidocSignatureSpan">nw-builder.</span>Version
            <span class="apidocSignatureSpan">(args)</span>
            </a>

        </li>

    </ol></li>

    <li class="apidocModuleLi"><a href="#apidoc.module.nw-builder.detectCurrentPlatform">module nw-builder.detectCurrentPlatform</a><ol>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.nw-builder.detectCurrentPlatform.detectCurrentPlatform">
            function <span class="apidocSignatureSpan">nw-builder.</span>detectCurrentPlatform
            <span class="apidocSignatureSpan">()</span>
            </a>

        </li>

    </ol></li>

    <li class="apidocModuleLi"><a href="#apidoc.module.nw-builder.downloader">module nw-builder.downloader</a><ol>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.nw-builder.downloader.checkCache">
            function <span class="apidocSignatureSpan">nw-builder.downloader.</span>checkCache
            <span class="apidocSignatureSpan">(cachepath, files)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.nw-builder.downloader.clearProgressbar">
            function <span class="apidocSignatureSpan">nw-builder.downloader.</span>clearProgressbar
            <span class="apidocSignatureSpan">()</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.nw-builder.downloader.downloadAndUnpack">
            function <span class="apidocSignatureSpan">nw-builder.downloader.</span>downloadAndUnpack
            <span class="apidocSignatureSpan">(cachepath, url)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.nw-builder.downloader.extractTar">
            function <span class="apidocSignatureSpan">nw-builder.downloader.</span>extractTar
            <span class="apidocSignatureSpan">(tarstream, destination)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.nw-builder.downloader.extractZip">
            function <span class="apidocSignatureSpan">nw-builder.downloader.</span>extractZip
            <span class="apidocSignatureSpan">(zipfile, destination)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.nw-builder.downloader.stripRootFolder">
            function <span class="apidocSignatureSpan">nw-builder.downloader.</span>stripRootFolder
            <span class="apidocSignatureSpan">(extracted)</span>
            </a>

        </li>

    </ol></li>

    <li class="apidocModuleLi"><a href="#apidoc.module.nw-builder.toString">module nw-builder.toString</a><ol>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.nw-builder.toString.toString">
            function <span class="apidocSignatureSpan">nw-builder.</span>toString
            <span class="apidocSignatureSpan">()</span>
            </a>

        </li>

    </ol></li>

    <li class="apidocModuleLi"><a href="#apidoc.module.nw-builder.utils">module nw-builder.utils</a><ol>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.nw-builder.utils.closerPathDepth">
            function <span class="apidocSignatureSpan">nw-builder.utils.</span>closerPathDepth
            <span class="apidocSignatureSpan">(path1, path2)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.nw-builder.utils.copyFile">
            function <span class="apidocSignatureSpan">nw-builder.utils.</span>copyFile
            <span class="apidocSignatureSpan">(src, dest, _event, options)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.nw-builder.utils.editPlist">
            function <span class="apidocSignatureSpan">nw-builder.utils.</span>editPlist
            <span class="apidocSignatureSpan">(plistInput, plistOutput, options)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.nw-builder.utils.generateZipFile">
            function <span class="apidocSignatureSpan">nw-builder.utils.</span>generateZipFile
            <span class="apidocSignatureSpan">(files, _event, platformSpecificManifest, zipOptions)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.nw-builder.utils.getFileList">
            function <span class="apidocSignatureSpan">nw-builder.utils.</span>getFileList
            <span class="apidocSignatureSpan">(fileglob)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.nw-builder.utils.getPackageInfo">
            function <span class="apidocSignatureSpan">nw-builder.utils.</span>getPackageInfo
            <span class="apidocSignatureSpan">(path)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.nw-builder.utils.getPlistOptions">
            function <span class="apidocSignatureSpan">nw-builder.utils.</span>getPlistOptions
            <span class="apidocSignatureSpan">(parsedParams, custom)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.nw-builder.utils.mergeFiles">
            function <span class="apidocSignatureSpan">nw-builder.utils.</span>mergeFiles
            <span class="apidocSignatureSpan">(app, zipfile, chmod)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.nw-builder.utils.pathDepth">
            function <span class="apidocSignatureSpan">nw-builder.utils.</span>pathDepth
            <span class="apidocSignatureSpan">(absolutePath)</span>
            </a>

        </li>

    </ol></li>

    <li class="apidocModuleLi"><a href="#apidoc.module.nw-builder.versions">module nw-builder.versions</a><ol>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.nw-builder.versions.getLatestVersion">
            function <span class="apidocSignatureSpan">nw-builder.versions.</span>getLatestVersion
            <span class="apidocSignatureSpan">(downloadUrl, manifestUrl, flavor)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.nw-builder.versions.getVersion">
            function <span class="apidocSignatureSpan">nw-builder.versions.</span>getVersion
            <span class="apidocSignatureSpan">(args)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.nw-builder.versions.getVersions">
            function <span class="apidocSignatureSpan">nw-builder.versions.</span>getVersions
            <span class="apidocSignatureSpan">(downloadUrl, manifestUrl, flavor)</span>
            </a>

        </li>

    </ol></li>

</ol></div>

<div class="apidocSectionDiv">
<h1><a href="#apidoc.module.nw-builder" id="apidoc.module.nw-builder">module nw-builder</a></h1>


    <h2>
        <a href="#apidoc.element.nw-builder.nw-builder" id="apidoc.element.nw-builder.nw-builder">
        function <span class="apidocSignatureSpan"></span>nw-builder
        <span class="apidocSignatureSpan">(options)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">function NwBuilder(options) {
    var defaults = {
        files: null,
        appName: false,
        appVersion: false,
        platforms: [&#x27;osx32&#x27;, &#x27;osx64&#x27;, &#x27;win32&#x27;, &#x27;win64&#x27;],
        currentPlatform: detectCurrentPlatform(),
        version: &#x27;latest&#x27;,
        buildDir: &#x27;./build&#x27;,
        cacheDir: &#x27;./cache&#x27;,
        downloadUrl: &#x27;https://dl.nwjs.io/&#x27;,
        manifestUrl: &#x27;https://nwjs.io/versions.json&#x27;,
        flavor: &#x27;sdk&#x27;,
        buildType: &#x27;default&#x27;,
        forceDownload: false,
        macCredits: false,
        macIcns: false,
        macZip: null,
        zip: null,
        zipOptions: null,
        macPlist: false,
        winIco: null,
        argv: process.argv.slice(2)
    };
    // Intercept the platforms and check for the legacy platforms of &#x27;osx&#x27; and &#x27;win&#x27; and
    // replace with &#x27;osx32&#x27;, &#x27;osx64&#x27;, and &#x27;win32&#x27;, &#x27;win64&#x27; respectively.
    if(typeof options.platforms != &#x27;undefined&#x27;){
        if(options.platforms.indexOf(&#x27;osx&#x27;) &#x3e;= 0){
            options.platforms.splice(options.platforms.indexOf(&#x27;osx&#x27;), 1, &#x27;osx32&#x27;, &#x27;osx64&#x27;);
        }
        if(options.platforms.indexOf(&#x27;win&#x27;) &#x3e;= 0){
            options.platforms.splice(options.platforms.indexOf(&#x27;win&#x27;), 1, &#x27;win32&#x27;, &#x27;win64&#x27;);
        }
        if(options.platforms.indexOf(&#x27;linux&#x27;) &#x3e;= 0){
            options.platforms.splice(options.platforms.indexOf(&#x27;linux&#x27;), 1, &#x27;linux32&#x27;, &#x27;linux64&#x27;);
        }
    }
    // Assign options
    this.options = _.defaults(options, defaults);

    // Some Option checking
    if(!this.options.files) {
        throw new Error(&#x27;Please specify some files&#x27;);
    }

    if (this.options.platforms.length === 0)
        throw new Error(&#x27;No platform to build!&#x27;);

    // verify all the platforms specifed by the user are supported
    // this + previous check assures as we have only buildable platforms specified
    this.options.platforms.forEach(function(platform) {
        if (!(platform in platforms))
            throw new Error(&#x27;Unknown platform &#x27; + platform);
    });

    this._platforms = _.cloneDeep(platforms);

    // clear all unused platforms
    for (var name in this._platforms) {
        if (this.options.platforms.indexOf(name) === -1)
            delete this._platforms[name];
    }
}</pre></li>
    <li>example usage<pre class="apidocCodePre">n/a</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.nw-builder.Version" id="apidoc.element.nw-builder.Version">
        function <span class="apidocSignatureSpan">nw-builder.</span>Version
        <span class="apidocSignatureSpan">(args)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">function Version(args){
    var generatePlatformUrls,
        result = {
            isLegacy: semver.satisfies(args.version, &#x27;&#x3c;0.12.3&#x27;),
            name: semver.satisfies(args.version, &#x27;&#x3e;=0.12.0 || ~0.12.0-alpha&#x27;) ? &#x27;nwjs&#x27; : &#x27;node-webkit&#x27;,
            version: args.version
        };

    // 0.12.3 is an exception that is in the manifest but is pretty much a legacy version
    if(result.isLegacy || args.version === &#x27;0.12.3&#x27;){
        generatePlatformUrls = function(version,flavors, supportedPlatforms){
            var platformUrls = {};
            supportedPlatforms.forEach(function (supportedPlatform) {
                flavors.forEach(function(flavor) {
                    platformUrls[supportedPlatform + &#x27;-&#x27; + flavor] = args.downloadUrl + _.template(platforms[supportedPlatform].
versionNameTemplate)(result);
                });
            });
            return platformUrls;
        };
    }
    else {
        var fixPlatformName = function(platform){
            return platform.replace(&#x27;32&#x27;, &#x27;-ia32&#x27;).replace(&#x27;64&#x27;, &#x27;-x64&#x27;);
        };

        var mapPlatformToExtension = function(platform){
            if(platform.indexOf(&#x27;linux&#x27;) === 0){
                return &#x27;tar.gz&#x27;
            }

            return &#x27;zip&#x27;
        };

        generatePlatformUrls = function(version, flavors, supportedPlatforms){
            var platformUrls = {};
            supportedPlatforms.forEach(function(platform){
                flavors.forEach(function(flavor) {
                    platformUrls[platform + &#x27;-&#x27; + flavor] = args.downloadUrl + &#x27;v&#x27; + version + &#x27;/nwjs&#x27; + (flavor === &#x27;normal&#x27; ? &#x27;&#x27; : &#x27;-&#x27; +
flavor) + &#x27;-v&#x27; + version + &#x27;-&#x27; + fixPlatformName(platform)
                        + &#x27;.&#x27; + mapPlatformToExtension(platform);
                });
            });
            return platformUrls;
        };
    }

    result.platforms = generatePlatformUrls(args.version, args.flavors, args.supportedPlatforms);
    return result;
}</pre></li>
    <li>example usage<pre class="apidocCodePre">n/a</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.nw-builder.detectCurrentPlatform" id="apidoc.element.nw-builder.detectCurrentPlatform">
        function <span class="apidocSignatureSpan">nw-builder.</span>detectCurrentPlatform
        <span class="apidocSignatureSpan">()</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">detectCurrentPlatform = function () {
	switch(process.platform) {
        case &#x27;darwin&#x27;:
            return process.arch === &#x27;x64&#x27; ? &#x27;osx64&#x27; : &#x27;osx32&#x27;;

        case &#x27;win32&#x27;:
            return (process.arch === &#x27;x64&#x27; || process.env.hasOwnProperty(&#x27;PROCESSOR_ARCHITEW6432&#x27;)) ? &#x27;win64&#x27; : &#x27;win32&#x27;;

        case &#x27;linux&#x27;:
            return process.arch === &#x27;x64&#x27; ? &#x27;linux64&#x27; : &#x27;linux32&#x27;;
	}
}</pre></li>
    <li>example usage<pre class="apidocCodePre">n/a</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.nw-builder.super_" id="apidoc.element.nw-builder.super_">
        function <span class="apidocSignatureSpan">nw-builder.</span>super_
        <span class="apidocSignatureSpan">()</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">function EventEmitter() {
  EventEmitter.init.call(this);
}</pre></li>
    <li>example usage<pre class="apidocCodePre">n/a</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.nw-builder.toString" id="apidoc.element.nw-builder.toString">
        function <span class="apidocSignatureSpan">nw-builder.</span>toString
        <span class="apidocSignatureSpan">()</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">toString = function () {
    return text;
}</pre></li>
    <li>example usage<pre class="apidocCodePre">...
        done.resolve({files:files, destination:destination});
    })
    .extract({
        path: destination,
        filter: function(entry) {
            files.push({
                path: entry.path,
                mode: entry.mode.<span class="apidocCodeKeywordSpan">toString</span>(8)
            });

            return true;
        }
    });

return done.promise;
...</pre></li>
    </ul>








</div>

<div class="apidocSectionDiv">
<h1><a href="#apidoc.module.nw-builder.Version" id="apidoc.module.nw-builder.Version">module nw-builder.Version</a></h1>


    <h2>
        <a href="#apidoc.element.nw-builder.Version.Version" id="apidoc.element.nw-builder.Version.Version">
        function <span class="apidocSignatureSpan">nw-builder.</span>Version
        <span class="apidocSignatureSpan">(args)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">function Version(args){
    var generatePlatformUrls,
        result = {
            isLegacy: semver.satisfies(args.version, &#x27;&#x3c;0.12.3&#x27;),
            name: semver.satisfies(args.version, &#x27;&#x3e;=0.12.0 || ~0.12.0-alpha&#x27;) ? &#x27;nwjs&#x27; : &#x27;node-webkit&#x27;,
            version: args.version
        };

    // 0.12.3 is an exception that is in the manifest but is pretty much a legacy version
    if(result.isLegacy || args.version === &#x27;0.12.3&#x27;){
        generatePlatformUrls = function(version,flavors, supportedPlatforms){
            var platformUrls = {};
            supportedPlatforms.forEach(function (supportedPlatform) {
                flavors.forEach(function(flavor) {
                    platformUrls[supportedPlatform + &#x27;-&#x27; + flavor] = args.downloadUrl + _.template(platforms[supportedPlatform].
versionNameTemplate)(result);
                });
            });
            return platformUrls;
        };
    }
    else {
        var fixPlatformName = function(platform){
            return platform.replace(&#x27;32&#x27;, &#x27;-ia32&#x27;).replace(&#x27;64&#x27;, &#x27;-x64&#x27;);
        };

        var mapPlatformToExtension = function(platform){
            if(platform.indexOf(&#x27;linux&#x27;) === 0){
                return &#x27;tar.gz&#x27;
            }

            return &#x27;zip&#x27;
        };

        generatePlatformUrls = function(version, flavors, supportedPlatforms){
            var platformUrls = {};
            supportedPlatforms.forEach(function(platform){
                flavors.forEach(function(flavor) {
                    platformUrls[platform + &#x27;-&#x27; + flavor] = args.downloadUrl + &#x27;v&#x27; + version + &#x27;/nwjs&#x27; + (flavor === &#x27;normal&#x27; ? &#x27;&#x27; : &#x27;-&#x27; +
flavor) + &#x27;-v&#x27; + version + &#x27;-&#x27; + fixPlatformName(platform)
                        + &#x27;.&#x27; + mapPlatformToExtension(platform);
                });
            });
            return platformUrls;
        };
    }

    result.platforms = generatePlatformUrls(args.version, args.flavors, args.supportedPlatforms);
    return result;
}</pre></li>
    <li>example usage<pre class="apidocCodePre">n/a</pre></li>
    </ul>


</div>

<div class="apidocSectionDiv">
<h1><a href="#apidoc.module.nw-builder.detectCurrentPlatform" id="apidoc.module.nw-builder.detectCurrentPlatform">module nw-builder.detectCurrentPlatform</a></h1>


    <h2>
        <a href="#apidoc.element.nw-builder.detectCurrentPlatform.detectCurrentPlatform" id="apidoc.element.nw-builder.detectCurrentPlatform.detectCurrentPlatform">
        function <span class="apidocSignatureSpan">nw-builder.</span>detectCurrentPlatform
        <span class="apidocSignatureSpan">()</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">detectCurrentPlatform = function () {
	switch(process.platform) {
        case &#x27;darwin&#x27;:
            return process.arch === &#x27;x64&#x27; ? &#x27;osx64&#x27; : &#x27;osx32&#x27;;

        case &#x27;win32&#x27;:
            return (process.arch === &#x27;x64&#x27; || process.env.hasOwnProperty(&#x27;PROCESSOR_ARCHITEW6432&#x27;)) ? &#x27;win64&#x27; : &#x27;win32&#x27;;

        case &#x27;linux&#x27;:
            return process.arch === &#x27;x64&#x27; ? &#x27;linux64&#x27; : &#x27;linux32&#x27;;
	}
}</pre></li>
    <li>example usage<pre class="apidocCodePre">n/a</pre></li>
    </ul>


</div>

<div class="apidocSectionDiv">
<h1><a href="#apidoc.module.nw-builder.downloader" id="apidoc.module.nw-builder.downloader">module nw-builder.downloader</a></h1>


    <h2>
        <a href="#apidoc.element.nw-builder.downloader.checkCache" id="apidoc.element.nw-builder.downloader.checkCache">
        function <span class="apidocSignatureSpan">nw-builder.downloader.</span>checkCache
        <span class="apidocSignatureSpan">(cachepath, files)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">checkCache = function (cachepath, files) {
    var missing;

    // if the version is &#x3e;=0.12.3, then we don&#x27;t which files we want from the archives, so just check that the folder
    // exists and has at least 3 files in it.
    if(files.length === 1 &#x26;&#x26; files[0] === &#x27;*&#x27;){
        return fs.existsSync(cachepath) &#x26;&#x26; fs.readdirSync(cachepath).length &#x3e;= 3;
    }

    files.forEach(function(file) {
        if (missing) {
            return;
        }
        if (!fs.existsSync(path.join(cachepath, file))) {
            missing = true;
        }
    });

    return !missing;
}</pre></li>
    <li>example usage<pre class="apidocCodePre">n/a</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.nw-builder.downloader.clearProgressbar" id="apidoc.element.nw-builder.downloader.clearProgressbar">
        function <span class="apidocSignatureSpan">nw-builder.downloader.</span>clearProgressbar
        <span class="apidocSignatureSpan">()</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">clearProgressbar = function () {
    bar &#x26;&#x26; bar.terminate();
    bar = null;
}</pre></li>
    <li>example usage<pre class="apidocCodePre">n/a</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.nw-builder.downloader.downloadAndUnpack" id="apidoc.element.nw-builder.downloader.downloadAndUnpack">
        function <span class="apidocSignatureSpan">nw-builder.downloader.</span>downloadAndUnpack
        <span class="apidocSignatureSpan">(cachepath, url)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">downloadAndUnpack = function (cachepath, url) {
    var extention = path.extname(url),
        done = Promise.defer(),
        self = this,
        rq = request(url),
        len,
        stream;

    function format(statusCode) {
        return statusCode + &#x27;: &#x27; + require(&#x27;http&#x27;).STATUS_CODES[statusCode];
    }

    rq.proxy = true;
    rq.on(&#x27;error&#x27;, function(err) {
        bar &#x26;&#x26; bar.terminate();
        done.reject(err);
    });
    rq.on(&#x27;response&#x27;, function (res) {
        len = parseInt(res.headers[&#x27;content-length&#x27;], 10);
        if (res.statusCode !== 200) {
            done.reject({
                statusCode: res.statusCode,
                msg: &#x27;Recieved status code &#x27; + format(res.statusCode)
            });
        } else if (len) {
            if (!bar) {
                bar = new progress(&#x27;  downloading [:bar] :percent :etas&#x27;, {
                    complete: &#x27;=&#x27;,
                    incomplete: &#x27;-&#x27;,
                    width: 20,
                    total: len
                });
            } else {
                bar.total += len;
            }
        }
    });
    rq.on(&#x27;data&#x27;, function(chunk) {
        len &#x26;&#x26; bar &#x26;&#x26; bar.tick(chunk.length);
    });

    if (extention === &#x27;.zip&#x27;) {
        stream = temp.createWriteStream();

        stream.on(&#x27;close&#x27;, function() {
            if(done.promise.isRejected()) return;
            self.extractZip(stream.path, cachepath).then(self.stripRootFolder).then(function(files) {
                done.resolve(files);
            });
        });

        rq.pipe(stream);
    }

    if (extention === &#x27;.gz&#x27;) {
        rq.on(&#x27;response&#x27;, function(res) {
            if(res.statusCode !== 200) return;
            self.extractTar(res, cachepath).then(self.stripRootFolder).then(function(files) {
                done.resolve(files);
            });
        });
    }

    return done.promise;
}</pre></li>
    <li>example usage<pre class="apidocCodePre">n/a</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.nw-builder.downloader.extractTar" id="apidoc.element.nw-builder.downloader.extractTar">
        function <span class="apidocSignatureSpan">nw-builder.downloader.</span>extractTar
        <span class="apidocSignatureSpan">(tarstream, destination)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">extractTar = function (tarstream, destination) {
    var done = Promise.defer(),
        gunzip = zlib.createGunzip(),
        files = [];

    tarstream
        .pipe(gunzip)
        .on(&#x27;error&#x27;, function(err){
            done.reject(err);
        })
        .pipe(tar.extract(destination, {
            umask: (isWin ? false : 0),
            map: function(header) {
                files.push({path: path.basename(header.name)});
                return header;
            }
        }))
        .on(&#x27;finish&#x27;, function() {
            done.resolve({files:files, destination:destination});
        });

    return done.promise;
}</pre></li>
    <li>example usage<pre class="apidocCodePre">...

        rq.pipe(stream);
    }

    if (extention === &#x27;.gz&#x27;) {
        rq.on(&#x27;response&#x27;, function(res) {
            if(res.statusCode !== 200) return;
            self.<span class="apidocCodeKeywordSpan">extractTar</span>(res, cachepath).then(self.stripRootFolder).then(function(
files) {
                done.resolve(files);
            });
        });
    }

    return done.promise;
},
...</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.nw-builder.downloader.extractZip" id="apidoc.element.nw-builder.downloader.extractZip">
        function <span class="apidocSignatureSpan">nw-builder.downloader.</span>extractZip
        <span class="apidocSignatureSpan">(zipfile, destination)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">extractZip = function (zipfile, destination) {
    var files = [],
        done = Promise.defer();

    new DecompressZip(zipfile)
        .on(&#x27;error&#x27;, function(err){
            done.reject(err);
        })
        .on(&#x27;extract&#x27;, function(log) {
            // Setup chmodSync to fix permissions
            files.forEach(function(file) {
                fs.chmodSync(path.join(destination, file.path), file.mode);
            });

            done.resolve({files:files, destination:destination});
        })
        .extract({
            path: destination,
            filter: function(entry) {
                files.push({
                    path: entry.path,
                    mode: entry.mode.toString(8)
                });

                return true;
            }
        });

    return done.promise;
}</pre></li>
    <li>example usage<pre class="apidocCodePre">...
});

if (extention === &#x27;.zip&#x27;) {
    stream = temp.createWriteStream();

    stream.on(&#x27;close&#x27;, function() {
        if(done.promise.isRejected()) return;
        self.<span class="apidocCodeKeywordSpan">extractZip</span>(stream.path, cachepath).then(self.stripRootFolder).then(function
(files) {
            done.resolve(files);
        });
    });

    rq.pipe(stream);
}
...</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.nw-builder.downloader.stripRootFolder" id="apidoc.element.nw-builder.downloader.stripRootFolder">
        function <span class="apidocSignatureSpan">nw-builder.downloader.</span>stripRootFolder
        <span class="apidocSignatureSpan">(extracted)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">stripRootFolder = function (extracted){
    var done = Promise.defer(),
        files = extracted.files,
        destination = extracted.destination,
        rootFiles = fs.readdirSync(destination),
        fromDir = path.join(destination, rootFiles.length === 1 ? rootFiles[0] : &#x27;&#x27;);

    // strip out root folder if it exists
    if(rootFiles.length === 1 &#x26;&#x26; fs.statSync(fromDir).isDirectory() ){
        // strip folder from files
        for (var i = 0; i &#x3c; files.length; i++) {
            var file = files[i];
            file.path = path.relative(rootFiles[0], file.path);
            if(file.path === &#x27;&#x27;) {
                files.splice(i, 1);
                i--;
            }
        }
        // move stripped folder to destination
        ncp(fromDir, destination, function (err) {
            if (err) done.reject();
            else rimraf(fromDir, function(){
                done.resolve(files);
            });
        });
    } else {
        done.resolve(files);
    }

    return done.promise;
}</pre></li>
    <li>example usage<pre class="apidocCodePre">n/a</pre></li>
    </ul>


</div>

<div class="apidocSectionDiv">
<h1><a href="#apidoc.module.nw-builder.toString" id="apidoc.module.nw-builder.toString">module nw-builder.toString</a></h1>


    <h2>
        <a href="#apidoc.element.nw-builder.toString.toString" id="apidoc.element.nw-builder.toString.toString">
        function <span class="apidocSignatureSpan">nw-builder.</span>toString
        <span class="apidocSignatureSpan">()</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">function toString() { [native code] }</pre></li>
    <li>example usage<pre class="apidocCodePre">...
        done.resolve({files:files, destination:destination});
    })
    .extract({
        path: destination,
        filter: function(entry) {
            files.push({
                path: entry.path,
                mode: entry.mode.<span class="apidocCodeKeywordSpan">toString</span>(8)
            });

            return true;
        }
    });

return done.promise;
...</pre></li>
    </ul>


</div>

<div class="apidocSectionDiv">
<h1><a href="#apidoc.module.nw-builder.utils" id="apidoc.module.nw-builder.utils">module nw-builder.utils</a></h1>


    <h2>
        <a href="#apidoc.element.nw-builder.utils.closerPathDepth" id="apidoc.element.nw-builder.utils.closerPathDepth">
        function <span class="apidocSignatureSpan">nw-builder.utils.</span>closerPathDepth
        <span class="apidocSignatureSpan">(path1, path2)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">closerPathDepth = function (path1, path2) {
    if (!path2) { return path1; }

    var d1 = this.pathDepth(path1),
        d2 = this.pathDepth(path2);

    return d1 &#x3c; d2 ? path1 : path2;
}</pre></li>
    <li>example usage<pre class="apidocCodePre">...

        return new Promise(function(resolve, reject) {
if(!matches.length) return reject(&#x27;No files matching&#x27;);

matches.forEach(function(file) {
    var internalFileName = path.normalize(file);
    if (internalFileName.match(&#x27;package.json&#x27;)) {
        jsonfile = self.<span class="apidocCodeKeywordSpan">closerPathDepth</span>(internalFileName, jsonfile);
        package_path = path.normalize(jsonfile.split(&#x27;package.json&#x27;)[0] || &#x27;./&#x27;);
    }
    if(!fs.lstatSync(internalFileName).isDirectory()) {
        srcFiles.push(internalFileName);
    }
});
...</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.nw-builder.utils.copyFile" id="apidoc.element.nw-builder.utils.copyFile">
        function <span class="apidocSignatureSpan">nw-builder.utils.</span>copyFile
        <span class="apidocSignatureSpan">(src, dest, _event, options)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">copyFile = function (src, dest, _event, options) {
    return new Promise(function(resolve, reject) {
        options = options || {};
        var stats = fs.lstatSync(src);
        fs.copy(src, dest, options, function (err) {
            if(err) return reject(err);

            var retryCount = 0;
            var existsCallback = function(exists){
                if(exists){
                    fs.chmod(dest, stats.mode, function(err){
                        // ignore error
                        if (err) {
                            _event.emit(&#x27;log&#x27;, &#x27;chmod &#x27; + stats.mode + &#x27; on &#x27; + dest + &#x27; failed after copying, ignoring&#x27;);
                        }

                        resolve();
                    });
                } else if (retryCount++ &#x3c; 2) {
                    // This is antipattern!!!
                    // Callback should be called when the copy is finished!!!!
                    setTimeout(function(){
                        fs.exists(dest, existsCallback);
                    }, 1000);
                } else {
                    reject(new Error(&#x22;Copied file (&#x22; + dest + &#x22;) doesn&#x27;t exist in destination after copying&#x22;));
                }
            };

            fs.exists(dest, existsCallback);
        });
    });
}</pre></li>
    <li>example usage<pre class="apidocCodePre">n/a</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.nw-builder.utils.editPlist" id="apidoc.element.nw-builder.utils.editPlist">
        function <span class="apidocSignatureSpan">nw-builder.utils.</span>editPlist
        <span class="apidocSignatureSpan">(plistInput, plistOutput, options)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">editPlist = function (plistInput, plistOutput, options) {
    options = options || {};

    // Make sure all required properties are set
    [
        &#x27;CFBundleName&#x27;,
        &#x27;CFBundleDisplayName&#x27;,
        &#x27;CFBundleVersion&#x27;,
        &#x27;CFBundleShortVersionString&#x27;
    ].forEach(function(prop) {
            if(!options.hasOwnProperty(prop)) {
                throw new Error(&#x27;Missing macPlist property \&#x27;&#x27; + prop + &#x27;\&#x27;&#x27;);
            }
        });

    // Bundle identifier based on package name
    if(options.CFBundleIdentifier === undefined) {
        options.CFBundleIdentifier = &#x27;com.nw-builder.&#x27; + options.CFBundleName.toLowerCase().replace(/[^a-z\-]/g,&#x27;&#x27;);
    }

    // Read the input file
    return readFile(plistInput, &#x27;utf8&#x27;)
        // Parse it
        .then(plist.parse)
        // Then overwrite the properties with custom values
        .then(function(info) {
            // Keep backwards compatibility and handle aliases
            Object.keys(options).forEach(function(key) {
                var value = options[key];
                switch(key) {
                    case &#x27;mac_bundle_id&#x27;:
                        info.CFBundleIdentifier = value;
                        break;
                    case &#x27;mac_document_types&#x27;:
                        info.CFBundleDocumentTypes = value.map(function(type) {
                            return {
                                CFBundleTypeName: type.name,
                                CFBundleTypeExtensions: type.extensions,
                                CFBundleTypeRole: type.role,
                                LSIsAppleDefaultForType: type.isDefault
                            };
                        });
                        break;
                    default:
                        info[key] = value;
                }
            });

            // Remove some unwanted properties
            if(!(options.hasOwnProperty(&#x27;mac_document_types&#x27;) || options.hasOwnProperty(&#x27;CFBundleDocumentTypes&#x27;))) {
                info.CFBundleDocumentTypes = [];
            }

            if(!options.hasOwnProperty(&#x27;UTExportedTypeDeclarations&#x27;))
                info.UTExportedTypeDeclarations = [];

            // Write output file
            return writeFile(plistOutput, plist.build(info));
        });
}</pre></li>
    <li>example usage<pre class="apidocCodePre">n/a</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.nw-builder.utils.generateZipFile" id="apidoc.element.nw-builder.utils.generateZipFile">
        function <span class="apidocSignatureSpan">nw-builder.utils.</span>generateZipFile
        <span class="apidocSignatureSpan">(files, _event, platformSpecificManifest, zipOptions)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">generateZipFile = function (files, _event, platformSpecificManifest, zipOptions) {
    var destStream = temp.createWriteStream(),
        archive = archiver(&#x27;zip&#x27;, zipOptions || {});

    return new Promise(function(resolve, reject) {

        // Resolve on close
        destStream.on(&#x27;close&#x27;, function () {
            resolve(destStream.path);
        });

        // Reject on Error
        archive.on(&#x27;error&#x27;, reject);

        // Add the files
        var filesBulk = [];
        files.forEach(function(file){
            if(file.dest === &#x27;package.json&#x27; &#x26;&#x26; platformSpecificManifest){
                archive.append(platformSpecificManifest, {name: &#x27;package.json&#x27;});
            }
            else
            {
                filesBulk.push({
                    src: file.src,
                    data: { name: path.basename(file.dest) },
                    expand: true,
                    flatten: true,
                    dest: path.dirname(file.dest)
                });
            }
        });
        archive.bulk(filesBulk);

        // Some logs
        archive.on(&#x27;entry&#x27;, function (file) {
            _event.emit(&#x27;log&#x27;, &#x27;Zipping &#x27; + file.name);
        });

        // Pipe the stream
        archive.pipe(destStream);
        archive.finalize();

    });
}</pre></li>
    <li>example usage<pre class="apidocCodePre">n/a</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.nw-builder.utils.getFileList" id="apidoc.element.nw-builder.utils.getFileList">
        function <span class="apidocSignatureSpan">nw-builder.utils.</span>getFileList
        <span class="apidocSignatureSpan">(fileglob)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">getFileList = function (fileglob) {
    var self = this,
        jsonfile, destFiles = [],
        srcFiles = [],
        package_path,
        matches = Glob(fileglob);

    return new Promise(function(resolve, reject) {
        if(!matches.length) return reject(&#x27;No files matching&#x27;);

        matches.forEach(function(file) {
            var internalFileName = path.normalize(file);
            if (internalFileName.match(&#x27;package.json&#x27;)) {
                jsonfile = self.closerPathDepth(internalFileName, jsonfile);
                package_path = path.normalize(jsonfile.split(&#x27;package.json&#x27;)[0] || &#x27;./&#x27;);
            }
            if(!fs.lstatSync(internalFileName).isDirectory()) {
                srcFiles.push(internalFileName);
            }
        });

        if (!jsonfile) {
            return reject(&#x27;Could not find a package.json in your src folder&#x27;);
        }

        srcFiles.forEach(function(file) {
            destFiles.push({
                src: file,
                dest: file.replace(package_path, &#x27;&#x27;)
            });
        });

        resolve({
            files: destFiles,
            json: jsonfile
        });
    });
}</pre></li>
    <li>example usage<pre class="apidocCodePre">n/a</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.nw-builder.utils.getPackageInfo" id="apidoc.element.nw-builder.utils.getPackageInfo">
        function <span class="apidocSignatureSpan">nw-builder.utils.</span>getPackageInfo
        <span class="apidocSignatureSpan">(path)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">getPackageInfo = function (path) {
    return new Promise(function(resolve, reject) {
        fs.readFile(path, function (err, data) {
            if (err) return reject(err);
            try {
                var appPkg = JSON.parse(data);
            } catch(e) {
                reject(&#x22;Invalid package.json: &#x22; + e + &#x22;\nMake sure the file is encoded as utf-8&#x22;);
                return;
            }
            if (!appPkg.name || !appPkg.version) {
                reject(&#x22;Please make sure that your project&#x27;s package.json includes a version and a name value&#x22;);
            } else {
                resolve(appPkg);
            }
        });
    });
}</pre></li>
    <li>example usage<pre class="apidocCodePre">n/a</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.nw-builder.utils.getPlistOptions" id="apidoc.element.nw-builder.utils.getPlistOptions">
        function <span class="apidocSignatureSpan">nw-builder.utils.</span>getPlistOptions
        <span class="apidocSignatureSpan">(parsedParams, custom)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">getPlistOptions = function (parsedParams, custom) {
    var obj = {};
    if(parsedParams.name) {
        obj.CFBundleName = parsedParams.name;
        obj.CFBundleDisplayName = parsedParams.name;
    }
    if(parsedParams.version) {
        obj.CFBundleVersion = parsedParams.version;
        obj.CFBundleShortVersionString = &#x27;Version &#x27; + parsedParams.version;
    }
    if(parsedParams.copyright) {
        obj.NSHumanReadableCopyright = parsedParams.copyright;
    }

    return _.merge(obj, custom);
}</pre></li>
    <li>example usage<pre class="apidocCodePre">n/a</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.nw-builder.utils.mergeFiles" id="apidoc.element.nw-builder.utils.mergeFiles">
        function <span class="apidocSignatureSpan">nw-builder.utils.</span>mergeFiles
        <span class="apidocSignatureSpan">(app, zipfile, chmod)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">mergeFiles = function (app, zipfile, chmod) {
    // we need to pipe the app into the zipfile and chmod it
    return new Promise(function(resolve, reject) {
        var zipStream = fs.createReadStream(zipfile),
            writeStream = fs.createWriteStream(app, {flags:&#x27;a&#x27;});

        zipStream.on(&#x27;error&#x27;, reject);
        writeStream.on(&#x27;error&#x27;, reject);

        writeStream.on(&#x27;finish&#x27;, function () {
            if(chmod) {
                fs.chmodSync(app, chmod);
            }
            resolve();
        });

        zipStream.pipe(writeStream);
    });
}</pre></li>
    <li>example usage<pre class="apidocCodePre">n/a</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.nw-builder.utils.pathDepth" id="apidoc.element.nw-builder.utils.pathDepth">
        function <span class="apidocSignatureSpan">nw-builder.utils.</span>pathDepth
        <span class="apidocSignatureSpan">(absolutePath)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">pathDepth = function (absolutePath) {
    return absolutePath.split(path.sep).length;
}</pre></li>
    <li>example usage<pre class="apidocCodePre">...
            json: jsonfile
        });
    });
},
closerPathDepth: function(path1, path2) {
    if (!path2) { return path1; }

    var d1 = this.<span class="apidocCodeKeywordSpan">pathDepth</span>(path1),
        d2 = this.pathDepth(path2);

    return d1 &#x3c; d2 ? path1 : path2;
},
pathDepth: function(absolutePath) {
    return absolutePath.split(path.sep).length;
},
...</pre></li>
    </ul>


</div>

<div class="apidocSectionDiv">
<h1><a href="#apidoc.module.nw-builder.versions" id="apidoc.module.nw-builder.versions">module nw-builder.versions</a></h1>


    <h2>
        <a href="#apidoc.element.nw-builder.versions.getLatestVersion" id="apidoc.element.nw-builder.versions.getLatestVersion">
        function <span class="apidocSignatureSpan">nw-builder.versions.</span>getLatestVersion
        <span class="apidocSignatureSpan">(downloadUrl, manifestUrl, flavor)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">getLatestVersion = function (downloadUrl, manifestUrl, flavor) {
    return getManifest(manifestUrl)
        .then(function(manifest) {
            return {
                desiredVersion: manifest.stable.replace(&#x27;v&#x27;, &#x27;&#x27;),
                downloadUrl: downloadUrl,
                manifestUrl: manifestUrl,
                flavor: flavor
            }
        })
        .then(this.getVersion);
}</pre></li>
    <li>example usage<pre class="apidocCodePre">n/a</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.nw-builder.versions.getVersion" id="apidoc.element.nw-builder.versions.getVersion">
        function <span class="apidocSignatureSpan">nw-builder.versions.</span>getVersion
        <span class="apidocSignatureSpan">(args)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">getVersion = function (args){
    return (isLegacyVersion(args.desiredVersion) ? getLegacyVersions : getVersionsFromManifest)(args.downloadUrl, args.manifestUrl
)
        .then(function(versions) {
            var version = versions.findIndex(function(version){
                return version.version === args.desiredVersion;
            });

            return version &#x3e;= 0
                ? Promise.resolve(versions[version])
                : Promise.reject(&#x27;Version &#x27; + args.desiredVersion + &#x27; not found.&#x27;);
        });
}</pre></li>
    <li>example usage<pre class="apidocCodePre">n/a</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.nw-builder.versions.getVersions" id="apidoc.element.nw-builder.versions.getVersions">
        function <span class="apidocSignatureSpan">nw-builder.versions.</span>getVersions
        <span class="apidocSignatureSpan">(downloadUrl, manifestUrl, flavor)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">getVersions = function (downloadUrl, manifestUrl, flavor){
    return Promise.all([
        getVersionsFromManifest(downloadUrl, manifestUrl, flavor),
        getLegacyVersions(downloadUrl, flavor)
    ])
        .then(function(versionLists){
            return versionLists[0].concat(versionLists[1]);
        });
}</pre></li>
    <li>example usage<pre class="apidocCodePre">n/a</pre></li>
    </ul>


</div>

<div class="apidocFooterDiv">
    [ this document was created with
    <a href="https://github.com/kaizhu256/node-utility2" target="_blank">utility2</a>
    ]
</div>
</div>
